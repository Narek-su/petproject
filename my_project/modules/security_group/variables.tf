variable "vpc_id" {
  type = string
}

variable "inbound_rule_keys" {
  type = list(string)
  #   default = ["ssh", "http", "https"] // how to use it
}

variable "override_cidrs" {
  type = map(list(string))
  #   default = {                        // how to use it
  #   ssh   = ["0.0.0.0/0"]
  #   http  = ["0.0.0.0/0"]
  #   https = ["0.0.0.0/0"]
  # }
}

variable "outbound_rule_keys" {
  type = list(string)
  #   default = ["all_traffic"]          // how to use it
}

variable "outbound_override_cidrs" {
  type = map(list(string))
    #   default = {                      // how to use it
    #   all_traffic = ["0.0.0.0/0"]
    # }
}

variable "sg_name" {
  type = string
}

#--------------------------------------------INBOUND RULES---------------------------------------------------#
variable "inbound_rules" {

  type = map(object({
    protocol  = string
    from_port = number
    to_port   = number
    cidr      = list(string)
  }))
  default = {
    custom_tcp = {
      protocol  = "tcp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_udp = {
      protocol  = "udp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_icmp_ipv4 = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_protocol = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_tcp = {
      protocol  = "tcp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_udp = {
      protocol  = "udp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_icmp_ipv4 = {
      protocol  = "icmp"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_icmp_ipv6 = {
      protocol  = "IPv6 ICMP"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_traffic = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    ssh = {
      protocol  = "tcp"
      from_port = 22
      to_port   = 22
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smtp = {
      protocol  = "tcp"
      from_port = 25
      to_port   = 25
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    dns_udp = {
      protocol  = "udp"
      from_port = 53
      to_port   = 53
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    dns_tcp = {
      protocol  = "tcp"
      from_port = 53
      to_port   = 53
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    http = {
      protocol  = "tcp"
      from_port = 80
      to_port   = 80
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    pop3 = {
      protocol  = "tcp"
      from_port = 110
      to_port   = 110
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    imap = {
      protocol  = "tcp"
      from_port = 143
      to_port   = 143
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    ldap = {
      protocol  = "tcp"
      from_port = 389
      to_port   = 389
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    https = {
      protocol  = "tcp"
      from_port = 443
      to_port   = 443
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smb = {
      protocol  = "tcp"
      from_port = 445
      to_port   = 445
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smtps = {
      protocol  = "tcp"
      from_port = 465
      to_port   = 465
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    imaps = {
      protocol  = "tcp"
      from_port = 993
      to_port   = 993
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    pop3s = {
      protocol  = "tcp"
      from_port = 995
      to_port   = 995
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    mssql = {
      protocol  = "tcp"
      from_port = 1433
      to_port   = 1433
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    nfs = {
      protocol  = "tcp"
      from_port = 2049
      to_port   = 2049
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    mysql_aurora = {
      protocol  = "tcp"
      from_port = 3306
      to_port   = 3306
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    rdp = {
      protocol  = "tcp"
      from_port = 3389
      to_port   = 3389
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    redshift = {
      protocol  = "tcp"
      from_port = 5439
      to_port   = 5439
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    postgresql = {
      protocol  = "tcp"
      from_port = 5432
      to_port   = 5432
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    oracle_rds = {
      protocol  = "tcp"
      from_port = 1521
      to_port   = 1521
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    winrm_http = {
      protocol  = "tcp"
      from_port = 5985
      to_port   = 5985
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    winrm_https = {
      protocol  = "tcp"
      from_port = 5986
      to_port   = 5986
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    elastic_graphics = {
      protocol  = "tcp"
      from_port = 2007
      to_port   = 2007
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    cqlsh_cassandra = {
      protocol  = "tcp"
      from_port = 9142
      to_port   = 9142
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
  }
}

#--------------------------------------------OUTBOUND RULES--------------------------------------------------#
variable "outbound_rules" {

  type = map(object({
    protocol  = string
    from_port = number
    to_port   = number
    cidr      = list(string)
  }))
  default = {
    custom_tcp = {
      protocol  = "tcp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_udp = {
      protocol  = "udp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_icmp_ipv4 = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    custom_protocol = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_tcp = {
      protocol  = "tcp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_udp = {
      protocol  = "udp"
      from_port = 0
      to_port   = 65535
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_icmp_ipv4 = {
      protocol  = "icmp"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_icmp_ipv6 = {
      protocol  = "IPv6 ICMP"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    all_traffic = {
      protocol  = "-1"
      from_port = -1
      to_port   = -1
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    ssh = {
      protocol  = "tcp"
      from_port = 22
      to_port   = 22
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smtp = {
      protocol  = "tcp"
      from_port = 25
      to_port   = 25
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    dns_udp = {
      protocol  = "udp"
      from_port = 53
      to_port   = 53
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    dns_tcp = {
      protocol  = "tcp"
      from_port = 53
      to_port   = 53
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    http = {
      protocol  = "tcp"
      from_port = 80
      to_port   = 80
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    pop3 = {
      protocol  = "tcp"
      from_port = 110
      to_port   = 110
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    imap = {
      protocol  = "tcp"
      from_port = 143
      to_port   = 143
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    ldap = {
      protocol  = "tcp"
      from_port = 389
      to_port   = 389
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    https = {
      protocol  = "tcp"
      from_port = 443
      to_port   = 443
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smb = {
      protocol  = "tcp"
      from_port = 445
      to_port   = 445
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    smtps = {
      protocol  = "tcp"
      from_port = 465
      to_port   = 465
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    imaps = {
      protocol  = "tcp"
      from_port = 993
      to_port   = 993
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    pop3s = {
      protocol  = "tcp"
      from_port = 995
      to_port   = 995
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    mssql = {
      protocol  = "tcp"
      from_port = 1433
      to_port   = 1433
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    nfs = {
      protocol  = "tcp"
      from_port = 2049
      to_port   = 2049
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    mysql_aurora = {
      protocol  = "tcp"
      from_port = 3306
      to_port   = 3306
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    rdp = {
      protocol  = "tcp"
      from_port = 3389
      to_port   = 3389
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    redshift = {
      protocol  = "tcp"
      from_port = 5439
      to_port   = 5439
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    postgresql = {
      protocol  = "tcp"
      from_port = 5432
      to_port   = 5432
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    oracle_rds = {
      protocol  = "tcp"
      from_port = 1521
      to_port   = 1521
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    winrm_http = {
      protocol  = "tcp"
      from_port = 5985
      to_port   = 5985
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    winrm_https = {
      protocol  = "tcp"
      from_port = 5986
      to_port   = 5986
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    elastic_graphics = {
      protocol  = "tcp"
      from_port = 2007
      to_port   = 2007
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
    cqlsh_cassandra = {
      protocol  = "tcp"
      from_port = 9142
      to_port   = 9142
      cidr      = ["0.0.0.0/0", "0.0.0.0/8", "0.0.0.0/16", "0.0.0.0/24", "0.0.0.0/32", "::/0", "::/16", "::/32", "::/48", "::/64"]
    }
  }
}

